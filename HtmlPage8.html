<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Recording Interface</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .recorder-container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 500px;
            padding: 30px;
            text-align: center;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .recording-controls {
            margin-bottom: 25px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-primary {
            background-color: #4a6ee0;
            color: white;
            box-shadow: 0 4px 15px rgba(74, 110, 224, 0.3);
        }

            .btn-primary:hover {
                background-color: #3a5ecf;
                transform: translateY(-2px);
            }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

            .btn-danger:hover {
                background-color: #c0392b;
                transform: translateY(-2px);
            }

        .btn-secondary {
            background-color: #95a5a6;
            color: white;
        }

            .btn-secondary:hover {
                background-color: #7f8c8d;
                transform: translateY(-2px);
            }

        .btn-success {
            background-color: #2ecc71;
            color: white;
        }

            .btn-success:hover {
                background-color: #27ae60;
                transform: translateY(-2px);
            }

        .timer {
            font-size: 36px;
            font-weight: 700;
            color: #333;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .transcript-container {
            margin: 25px 0;
            text-align: left;
        }

        textarea {
            width: 100%;
            height: 150px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            font-size: 16px;
            resize: vertical;
            transition: border-color 0.3s;
        }

            textarea:focus {
                outline: none;
                border-color: #4a6ee0;
            }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .status {
            margin-top: 15px;
            font-size: 14px;
            color: #666;
            min-height: 20px;
        }

        .icon {
            margin-right: 8px;
            font-size: 18px;
        }

        .hidden {
            display: none;
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7);
            }

            70% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(231, 76, 60, 0);
            }

            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(231, 76, 60, 0);
            }
        }

        .visualizer {
            height: 80px;
            width: 100%;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .bar {
            width: 6px;
            height: 10px;
            background: #4a6ee0;
            margin: 0 2px;
            border-radius: 3px;
            animation: equalizer 1.5s ease infinite;
        }

            .bar:nth-child(1) {
                animation-delay: 0s;
            }

            .bar:nth-child(2) {
                animation-delay: 0.1s;
            }

            .bar:nth-child(3) {
                animation-delay: 0.2s;
            }

            .bar:nth-child(4) {
                animation-delay: 0.3s;
            }

            .bar:nth-child(5) {
                animation-delay: 0.4s;
            }

            .bar:nth-child(6) {
                animation-delay: 0.5s;
            }

            .bar:nth-child(7) {
                animation-delay: 0.6s;
            }

            .bar:nth-child(8) {
                animation-delay: 0.7s;
            }

        @keyframes equalizer {
            0%, 100% {
                height: 10px;
            }

            50% {
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="recorder-container">
        <h1>Voice Recorder</h1>
        <p class="subtitle">Click start to begin recording your voice</p>

        <div class="recording-controls">
            <button id="startBtn" class="btn btn-primary">
                <span class="icon">🎤</span> Start Recording
            </button>

            <div id="recordingControls" class="hidden">
                <div class="visualizer">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                </div>

                <div class="timer" id="timer">00:00</div>

                <button id="stopBtn" class="btn btn-danger pulse">
                    <span class="icon">⏹️</span> Stop Recording
                </button>

                <button id="muteBtn" class="btn btn-secondary">
                    <span class="icon">🔇</span> Mute
                </button>
            </div>
        </div>

        <div class="transcript-container">
            <textarea id="transcript" placeholder="Your transcript will appear here..."></textarea>
        </div>

        <div id="actionButtons" class="action-buttons hidden">
            <button id="cancelBtn" class="btn btn-secondary">
                <span class="icon">❌</span> Cancel
            </button>
            <button id="submitBtn" class="btn btn-success">
                <span class="icon">✅</span> Submit
            </button>
        </div>

        <div class="status" id="status"></div>
    </div>

    <script>
        $(document).ready(function () {
            // Variables for recording functionality
            let mediaRecorder;
            let audioChunks = [];
            let timerInterval;
            let seconds = 0;
            let isRecording = false;
            let isMuted = false;

            // Speech recognition setup (for transcript)
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            let recognition;

            if (SpeechRecognition) {
                recognition = new SpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'en-US';

                recognition.onresult = function (event) {
                    let transcript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        if (event.results[i].isFinal) {
                            transcript += event.results[i][0].transcript;
                        } else {
                            transcript += event.results[i][0].transcript;
                        }
                    }
                    $('#transcript').val($('#transcript').val() + transcript);
                };

                recognition.onerror = function (event) {
                    console.error('Speech recognition error', event.error);
                    $('#status').text('Speech recognition error: ' + event.error);
                };
            }
            else
            {
                $('#status').text('Speech recognition not supported in this browser. Transcript will not work.');
            }

            // Start recording button click
            $('#startBtn').click(function () {
                startRecording();
            });

            // Stop recording button click
            $('#stopBtn').click(function () {
                stopRecording();
            });

            // Mute button click
            $('#muteBtn').click(function () {
                toggleMute();
            });

            // Cancel button click
            $('#cancelBtn').click(function () {
                cancelRecording();
            });

            // Submit button click
            $('#submitBtn').click(function () {
                submitRecording();
            });

            // Function to start recording
            function startRecording() {
                if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                    navigator.mediaDevices.getUserMedia({ audio: true })
                        .then(function (stream) {
                            // Hide start button, show recording controls
                            $('#startBtn').addClass('hidden');
                            $('#recordingControls').removeClass('hidden');
                            $('#actionButtons').removeClass('hidden');

                            // Start timer
                            startTimer();

                            // Start speech recognition
                            if (recognition) {
                                recognition.start();
                            }

                            // Set up media recorder
                            mediaRecorder = new MediaRecorder(stream);
                            mediaRecorder.start();
                            isRecording = true;

                            mediaRecorder.ondataavailable = function (event) {
                                audioChunks.push(event.data);
                            };

                            $('#status').text('Recording in progress...');
                        })
                        .catch(function (err) {
                            console.error('Error accessing microphone:', err);
                            $('#status').text('Error accessing microphone: ' + err.message);
                        });
                } else {
                    $('#status').text('getUserMedia not supported in this browser.');
                }
            }

            // Function to stop recording
            function stopRecording() {
                if (mediaRecorder && isRecording) {
                    mediaRecorder.stop();
                    isRecording = false;

                    // Stop timer
                    clearInterval(timerInterval);

                    // Stop speech recognition
                    if (recognition) {
                        recognition.stop();
                    }

                    // Stop all audio tracks
                    mediaRecorder.stream.getTracks().forEach(track => track.stop());

                    $('#status').text('Recording stopped. You can now submit or cancel.');
                }
            }

            // Function to toggle mute
            function toggleMute() {
                if (mediaRecorder && mediaRecorder.stream) {
                    const audioTracks = mediaRecorder.stream.getAudioTracks();

                    if (audioTracks.length > 0) {
                        isMuted = !isMuted;
                        audioTracks[0].enabled = !isMuted;

                        if (isMuted) {
                            $('#muteBtn').html('<i class="fa-solid fa-microphone"></i> <span>Unmute</span>');
                            $('#status').text('Microphone is muted');
                        } else {
                            $('#muteBtn').html('<i class="fa-solid fa-microphone-slash"></i> <span>Mute</span>');
                            $('#status').text('Microphone is unmuted');
                        }
                    }
                }
            }

            // Function to start timer
            function startTimer() {
                seconds = 0;
                timerInterval = setInterval(function () {
                    seconds++;
                    const minutes = Math.floor(seconds / 60);
                    const remainingSeconds = seconds % 60;
                    $('#timer').text(
                        (minutes < 10 ? '0' : '') + minutes + ':' +
                        (remainingSeconds < 10 ? '0' : '') + remainingSeconds
                    );
                }, 1000);
            }

            // Function to cancel recording
            function cancelRecording() {
                if (isRecording) {
                    stopRecording();
                }

                // Reset UI
                $('#recordingControls').addClass('hidden');
                $('#actionButtons').addClass('hidden');
                $('#startBtn').removeClass('hidden');
                $('#transcript').val('');
                $('#timer').text('00:00');
                $('#status').text('Recording canceled');
                $('#muteBtn').html('<span class="icon">🔇</span> Mute');
                isMuted = false;

                // Clear audio chunks
                audioChunks = [];
            }

            // Function to submit recording
            function submitRecording() {
                if (isRecording) {
                    stopRecording();
                }

                const transcript = $('#transcript').val();

                if (transcript.trim() === '') {
                    $('#status').text('No transcript to submit. Please record something first.');
                    return;
                }

                // In a real application, you would send the audio and transcript to a server
                $('#status').html('Recording submitted successfully!<br>Transcript: ' + transcript.substring(0, 100) + '...');

                // Reset UI after a delay
                setTimeout(function () {
                    $('#recordingControls').addClass('hidden');
                    $('#actionButtons').addClass('hidden');
                    $('#startBtn').removeClass('hidden');
                    $('#transcript').val('');
                    $('#timer').text('00:00');
                    $('#muteBtn').html('<span class="icon">🔇</span> Mute');
                    isMuted = false;
                    audioChunks = [];
                }, 3000);
            }
        });
    </script>
</body>
</html>